struct Kernels end

function kernel_step(tr::Trace,
